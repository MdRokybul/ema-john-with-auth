{"ast":null,"code":"var _jsxFileName = \"E:\\\\NodeJS\\\\mongo\\\\New folder\\\\ema-john-with-auth\\\\src\\\\components\\\\Login\\\\Login.js\";\nimport React, { useState } from 'react';\nimport { useContext } from 'react';\nimport { UserContext } from '../../App';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { initializeLoginFramework, handleGoogleSignIn, handleSignOut, handleFbSignIn, createUserWithEmailAndPassword, signInWithEmailAndPassword } from './loginManager';\n\nfunction Login() {\n  const [newUser, setNewUser] = useState(false);\n  const [user, setUser] = useState({\n    isSignedIn: false,\n    name: '',\n    email: '',\n    password: '',\n    photo: ''\n  });\n  initializeLoginFramework();\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const history = useHistory();\n  const location = useLocation();\n  let {\n    from\n  } = location.state || {\n    from: {\n      pathname: \"/\"\n    }\n  };\n\n  const googleSignIn = () => {\n    handleGoogleSignIn().then(res => {\n      handleResponse(res, true);\n    });\n  };\n\n  const fbSignIn = () => {\n    handleFbSignIn().then(res => {\n      handleResponse(res, true);\n    });\n  };\n\n  const signOut = () => {\n    handleSignOut().then(res => {\n      handleResponse(res, false);\n    });\n  };\n\n  const handleResponse = (res, redirect) => {\n    setUser(res);\n    setLoggedInUser(res);\n\n    if (redirect) {\n      history.replace(from);\n    }\n  };\n\n  const handleBlur = e => {\n    let isFieldValid = true;\n\n    if (e.target.name === 'email') {\n      isFieldValid = /\\S+@\\S+\\.\\S+/.test(e.target.value);\n    }\n\n    if (e.target.name === 'password') {\n      const isPasswordValid = e.target.value.length > 6;\n      const passwordHasNumber = /\\d{1}/.test(e.target.value);\n      isFieldValid = isPasswordValid && passwordHasNumber;\n    }\n\n    if (isFieldValid) {\n      const newUserInfo = { ...user\n      };\n      newUserInfo[e.target.name] = e.target.value;\n      setUser(newUserInfo);\n    }\n  };\n\n  const handleSubmit = e => {\n    if (newUser && user.email && user.password) {\n      createUserWithEmailAndPassword(user.name, user.email, user.password).then(res => {\n        handleResponse(res, true);\n      });\n    }\n\n    if (!newUser && user.email && user.password) {\n      signInWithEmailAndPassword(user.email, user.password).then(res => {\n        handleResponse(res, true);\n      });\n    }\n\n    e.preventDefault();\n  };\n\n  return React.createElement(\"div\", {\n    style: {\n      textAlign: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, user.isSignedIn ? React.createElement(\"button\", {\n    onClick: signOut,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, \"Sign Out\") : React.createElement(\"button\", {\n    onClick: googleSignIn,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, \"Sign In\"), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    onClick: fbSignIn,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, \"Sign in using Facebook\"), user.isSignedIn && React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \"Welcome, \", user.name, \"!\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, \"Your email: \", user.email), React.createElement(\"img\", {\n    src: user.photo,\n    alt: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  })), React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, \"Our own Authentication\"), React.createElement(\"input\", {\n    type: \"checkbox\",\n    onChange: () => setNewUser(!newUser),\n    name: \"newUser\",\n    id: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }), React.createElement(\"label\", {\n    htmlFor: \"newUser\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"New User Sign up\"), React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, newUser && React.createElement(\"input\", {\n    name: \"name\",\n    type: \"text\",\n    onBlur: handleBlur,\n    placeholder: \"Your name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"text\",\n    name: \"email\",\n    onBlur: handleBlur,\n    placeholder: \"Your Email address\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    onBlur: handleBlur,\n    placeholder: \"Your Password\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"submit\",\n    value: newUser ? 'Sign up' : 'Sign in',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  })), React.createElement(\"p\", {\n    style: {\n      color: 'red'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, user.error), user.success && React.createElement(\"p\", {\n    style: {\n      color: 'green'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, \"User \", newUser ? 'created' : 'Logged In', \" successfully\"));\n}\n\nexport default Login;","map":{"version":3,"sources":["E:/NodeJS/mongo/New folder/ema-john-with-auth/src/components/Login/Login.js"],"names":["React","useState","useContext","UserContext","useHistory","useLocation","initializeLoginFramework","handleGoogleSignIn","handleSignOut","handleFbSignIn","createUserWithEmailAndPassword","signInWithEmailAndPassword","Login","newUser","setNewUser","user","setUser","isSignedIn","name","email","password","photo","loggedInUser","setLoggedInUser","history","location","from","state","pathname","googleSignIn","then","res","handleResponse","fbSignIn","signOut","redirect","replace","handleBlur","e","isFieldValid","target","test","value","isPasswordValid","length","passwordHasNumber","newUserInfo","handleSubmit","preventDefault","textAlign","color","error","success"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { useContext } from 'react';\r\nimport { UserContext } from '../../App';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\nimport { initializeLoginFramework, handleGoogleSignIn, handleSignOut, handleFbSignIn, createUserWithEmailAndPassword, signInWithEmailAndPassword } from './loginManager';\r\n\r\n\r\n\r\nfunction Login() {\r\n  const [newUser, setNewUser] = useState(false);\r\n  const [user, setUser] = useState({\r\n    isSignedIn: false,\r\n    name: '',\r\n    email: '',\r\n    password: '',\r\n    photo: ''\r\n  });\r\n\r\n  initializeLoginFramework();\r\n\r\n  const [loggedInUser, setLoggedInUser ] = useContext(UserContext);\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  let { from } = location.state || { from: { pathname: \"/\" } };\r\n\r\n  const googleSignIn = () => {\r\n      handleGoogleSignIn()\r\n      .then(res => {\r\n        handleResponse(res, true);\r\n      })\r\n  }\r\n\r\n  const fbSignIn = () => {\r\n      handleFbSignIn()\r\n      .then(res => {\r\n        handleResponse(res, true);\r\n      })\r\n\r\n  }\r\n\r\n  const signOut = () => {\r\n      handleSignOut()\r\n      .then(res => {\r\n          handleResponse(res, false);\r\n      })\r\n  }\r\n\r\n  const handleResponse = (res, redirect) =>{\r\n    setUser(res);\r\n    setLoggedInUser(res);\r\n    if(redirect){\r\n        history.replace(from);\r\n    }\r\n  }\r\n\r\n  const handleBlur = (e) => {\r\n    let isFieldValid = true;\r\n    if(e.target.name === 'email'){\r\n      isFieldValid = /\\S+@\\S+\\.\\S+/.test(e.target.value);\r\n    }\r\n    if(e.target.name === 'password'){\r\n      const isPasswordValid = e.target.value.length > 6;\r\n      const passwordHasNumber =  /\\d{1}/.test(e.target.value);\r\n      isFieldValid = isPasswordValid && passwordHasNumber;\r\n    }\r\n    if(isFieldValid){\r\n      const newUserInfo = {...user};\r\n      newUserInfo[e.target.name] = e.target.value;\r\n      setUser(newUserInfo);\r\n    }\r\n  }\r\n  const handleSubmit = (e) => {\r\n    if(newUser && user.email && user.password){\r\n      createUserWithEmailAndPassword(user.name, user.email, user.password)\r\n      .then(res => {\r\n        handleResponse(res, true);\r\n      })\r\n    }\r\n\r\n    if(!newUser && user.email && user.password){\r\n      signInWithEmailAndPassword(user.email, user.password)\r\n      .then(res => {\r\n        handleResponse(res, true);\r\n      })\r\n    }\r\n    e.preventDefault();\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <div style={{textAlign: 'center'}}>\r\n      { user.isSignedIn ? <button onClick={signOut}>Sign Out</button> :\r\n        <button onClick={googleSignIn}>Sign In</button>\r\n      }\r\n      <br/>\r\n      <button onClick={fbSignIn}>Sign in using Facebook</button>\r\n      {\r\n        user.isSignedIn && <div>\r\n          <p>Welcome, {user.name}!</p>\r\n          <p>Your email: {user.email}</p>\r\n          <img src={user.photo} alt=\"\"/>\r\n        </div>\r\n      }\r\n\r\n      <h1>Our own Authentication</h1>\r\n      <input type=\"checkbox\" onChange={() => setNewUser(!newUser)} name=\"newUser\" id=\"\"/>\r\n      <label htmlFor=\"newUser\">New User Sign up</label>\r\n      <form onSubmit={handleSubmit}>\r\n        {newUser && <input name=\"name\" type=\"text\" onBlur={handleBlur} placeholder=\"Your name\"/>}\r\n        <br/>\r\n        <input type=\"text\" name=\"email\" onBlur={handleBlur} placeholder=\"Your Email address\" required/>\r\n        <br/>\r\n        <input type=\"password\" name=\"password\" onBlur={handleBlur} placeholder=\"Your Password\" required/>\r\n        <br/>\r\n        <input type=\"submit\" value={newUser ? 'Sign up' : 'Sign in'}/>\r\n      </form>\r\n      <p style={{color: 'red'}}>{user.error}</p>\r\n      { user.success && <p style={{color: 'green'}}>User { newUser ? 'created' : 'Logged In'} successfully</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}